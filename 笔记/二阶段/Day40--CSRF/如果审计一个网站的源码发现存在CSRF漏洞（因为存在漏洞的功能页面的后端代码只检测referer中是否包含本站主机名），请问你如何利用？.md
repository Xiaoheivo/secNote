##### 如果审计一个网站的源码发现存在CSRF漏洞（因为存在漏洞的功能页面的后端代码只检测referer中是否包含本站主机名），请问你如何利用？

- 访问该网站
- 注册一个账号
- 访问存在CSRF漏洞的页面,查看该页面的功能
- 正常使用该功能,并拦截存在CSRF漏洞的请求
- 根据请求包的内容,伪造一个新的请求
- 由于已经提前审计过代码,知道后端验证referer的时候只会验证referer中是否包含主机名,没有进行完整的匹配,所以只需要
  - 将伪造的请求放到一个文件名包含目标站点主机名的网页文件中,将该文件上传到我们的服务器
  - 或者直接将包含伪造请求的网页文件上传到我们的服务器,使用可以自定义目录名的短链接生成工具,将短连接生成的url中的目录定义成目标站点的主机名
- 通过邮件,短信等等各种方式,将链接投放给受害者,诱导其点击链接,达到伪造受害者请求的目的

